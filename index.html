<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CRETA - 창작자를 위한 플랫폼</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Pretendard:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <script src="https://developers.kakao.com/sdk/js/kakao.js"></script>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <!-- 로딩 화면 -->
    <div id="loadingScreen" class="loading-screen">
        <div class="loading-content">
            <div class="logo">
                <span class="logo-icon">🎨</span>
                <span class="logo-text">CRETA</span>
            </div>
            <div class="loading-spinner"></div>
            <p>창작의 세계로 입장 중...</p>
        </div>
    </div>

    <!-- 인증 모달 - 스크롤 가능하고 X 버튼 있는 버전 -->
    <div id="authModal" class="auth-modal-overlay" style="display: none;">
        <div class="auth-modal-container">
            <button class="auth-close-btn" onclick="closeAuthModal()">×</button>
            <div class="auth-modal-content">
                <div class="auth-header">
                    <div class="logo">
                        <span class="logo-icon">🎨</span>
                        <span class="logo-text">CRETA</span>
                    </div>
                    <h2>창작자들의 플랫폼에 오신 것을 환영합니다</h2>
                </div>

                <div class="auth-tabs">
                    <button class="auth-tab active" onclick="switchAuthTab('login')" data-tab="login">로그인</button>
                    <button class="auth-tab" onclick="switchAuthTab('signup')" data-tab="signup">회원가입</button>
                </div>

                <!-- 로그인 폼 -->
                <div id="loginForm" class="auth-form active">
                    <div class="form-group">
                        <input type="email" id="loginEmail" placeholder="이메일을 입력하세요" class="auth-input">
                    </div>
                    <div class="form-group">
                        <input type="password" id="loginPassword" placeholder="비밀번호를 입력하세요" class="auth-input">
                    </div>
                    
                    <div class="auth-options">
                        <label class="checkbox-label">
                            <input type="checkbox" id="rememberMe">
                            <span class="checkmark"></span>
                            <span>로그인 상태 유지</span>
                        </label>
                        <a href="#" class="forgot-link">비밀번호 찾기</a>
                    </div>

                    <button class="auth-btn primary" onclick="loginUser()">로그인</button>
                    
                    <div class="social-divider">
                        <span>또는 간편 로그인</span>
                    </div>

                    <div class="social-buttons">
                        <button class="social-btn google" onclick="socialLogin('google')">
                            <span class="social-icon">G</span>구글로 시작하기
                        </button>
                        <button class="social-btn kakao" onclick="socialLogin('kakao')">
                            <span class="social-icon">K</span>카카오로 시작하기
                        </button>
                        <button class="social-btn naver" onclick="socialLogin('naver')">
                            <span class="social-icon">N</span>네이버로 시작하기
                        </button>
                    </div>
                </div>

                <!-- 회원가입 폼 -->
                <div id="signupForm" class="auth-form">
                    <div class="form-group">
                        <input type="text" id="signupName" placeholder="닉네임을 입력하세요" class="auth-input">
                    </div>
                    <div class="form-group">
                        <input type="email" id="signupEmail" placeholder="이메일을 입력하세요" class="auth-input">
                    </div>
                    <div class="form-group">
                        <input type="password" id="signupPassword" placeholder="비밀번호 (8자 이상)" class="auth-input">
                    </div>
                    <div class="form-group">
                        <input type="password" id="signupPasswordConfirm" placeholder="비밀번호 확인" class="auth-input">
                    </div>
                    
                    <label class="checkbox-label">
                        <input type="checkbox" id="agreeTerms">
                        <span class="checkmark"></span>
                        <span>이용약관 및 개인정보처리방침에 동의합니다</span>
                    </label>

                    <button class="auth-btn primary" onclick="signupUser()">회원가입</button>
                    
                    <div class="social-divider">
                        <span>또는 간편 가입</span>
                    </div>

                    <div class="social-buttons">
                        <button class="social-btn google" onclick="socialSignup('google')">
                            <span class="social-icon">G</span>구글로 가입하기
                        </button>
                        <button class="social-btn kakao" onclick="socialSignup('kakao')">
                            <span class="social-icon">K</span>카카오로 가입하기
                        </button>
                        <button class="social-btn naver" onclick="socialSignup('naver')">
                            <span class="social-icon">N</span>네이버로 가입하기
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- 메인 앱 -->
    <div id="mainApp" class="main-app" style="display: none;">
        <!-- 헤더 -->
        <header class="app-header">
            <div class="header-content">
                <div class="logo" onclick="navigateTo('home')">
                    <span class="logo-icon">🎨</span>
                    <span class="logo-text">CRETA</span>
                </div>
                
                <!-- 새로운 검색바 - 가로로 넓게 -->
                <div class="header-search">
                    <div class="search-container">
                        <span class="search-icon">🔍</span>
                        <input type="text" id="globalSearchInput" placeholder="작품, 작가, 태그로 검색..." 
                               onkeypress="handleGlobalSearch(event)" onfocus="showGlobalSearchSuggestions()">
                        <button class="search-clear" onclick="clearGlobalSearch()" style="display: none;">×</button>
                    </div>
                    
                    <!-- 전역 검색 제안 패널 -->
                    <div id="globalSearchSuggestions" class="global-suggestions-panel" style="display: none;">
                        <div class="suggestions-content">
                            <div class="suggestion-section">
                                <h4>🔥 실시간 인기</h4>
                                <div class="trending-keywords" id="globalTrendingKeywords"></div>
                            </div>
                            <div class="suggestion-section">
                                <h4>🎯 추천 검색어</h4>
                                <div class="suggested-keywords" id="globalSuggestedKeywords"></div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="header-actions">
                    <button class="theme-toggle" onclick="toggleDarkMode()" title="다크 모드로 전환">🌙</button>
                    <button class="header-btn notification-btn" onclick="openNotifications()">
                        <span class="icon">🔔</span>
                        <span class="badge">3</span>
                    </button>
                    <div class="user-profile" onclick="goToProfile()">
                        <span id="userInitial">U</span>
                    </div>
                    <button class="header-btn logout" onclick="logoutUser()" style="display: none;">
                        로그아웃
                    </button>
                </div>
            </div>
        </header>

        <div class="app-body">
            <!-- 사이드바 - 스와이프 가능 -->
            <nav class="sidebar" id="sidebar">
                <div class="sidebar-header">
                    <button class="sidebar-toggle" onclick="toggleSidebar()">☰</button>
                    <span class="sidebar-title">메뉴</span>
                </div>
                
                <div class="nav-items">
                    <button class="nav-item active" onclick="navigateTo('home')" data-page="home">
                        <span class="nav-icon">🏠</span>
                        <span class="nav-text">홈</span>
                    </button>
                    <button class="nav-item" onclick="navigateTo('explore')" data-page="explore">
                        <span class="nav-icon">🔍</span>
                        <span class="nav-text">탐색</span>
                    </button>
                    <button class="nav-item" onclick="navigateTo('community')" data-page="community">
                        <span class="nav-icon">👥</span>
                        <span class="nav-text">커뮤니티</span>
                    </button>
                    <button class="nav-item" onclick="navigateTo('messages')" data-page="messages">
                        <span class="nav-icon">💬</span>
                        <span class="nav-text">메시지</span>
                        <span class="nav-badge">2</span>
                    </button>
                    <button class="nav-item" onclick="navigateTo('profile')" data-page="profile">
                        <span class="nav-icon">👤</span>
                        <span class="nav-text">프로필</span>
                    </button>
                    
                    <div class="nav-divider"></div>
                    
                    <button class="nav-item upload" onclick="navigateToUpload()">
                        <span class="nav-icon">➕</span>
                        <span class="nav-text">작품 업로드</span>
                    </button>
                </div>
            </nav>

            <!-- 메인 콘텐츠 -->
            <main class="main-content" id="mainContent">
                <!-- 홈 페이지 -->
                <div id="homePage" class="page active">
                    <div class="home-hero">
                        <h1>안녕하세요, <span id="welcomeName">창작자</span>님! 🎨</h1>
                        <p>CRETA에서 여러분의 창작 여정을 시작해보세요</p>
                    </div>

                    <!-- 작품 섹션들 - 스와이프 가능 -->
                    <section class="content-section">
                        <div class="section-header">
                            <h2>🔥 최신 업로드 작품</h2>
                            <button class="see-more-btn" onclick="navigateTo('explore')">더보기</button>
                        </div>
                        <div class="works-carousel-container">
                            <button class="carousel-btn prev" onclick="slideWorksCarousel('latest', -1)">‹</button>
                            <div class="works-carousel" id="latestWorksCarousel">
                                <!-- 작품들이 동적으로 로드됩니다 -->
                            </div>
                            <button class="carousel-btn next" onclick="slideWorksCarousel('latest', 1)">›</button>
                        </div>
                    </section>

                    <section class="content-section">
                        <div class="section-header">
                            <h2>📈 인기 급상승</h2>
                            <button class="see-more-btn" onclick="navigateTo('explore')">더보기</button>
                        </div>
                        <div class="works-carousel-container">
                            <button class="carousel-btn prev" onclick="slideWorksCarousel('trending', -1)">‹</button>
                            <div class="works-carousel" id="trendingWorksCarousel">
                                <!-- 작품들이 동적으로 로드됩니다 -->
                            </div>
                            <button class="carousel-btn next" onclick="slideWorksCarousel('trending', 1)">›</button>
                        </div>
                    </section>

                    <section class="content-section">
                        <div class="section-header">
                            <h2>⭐ 스테디셀러</h2>
                            <button class="see-more-btn" onclick="navigateTo('explore')">더보기</button>
                        </div>
                        <div class="works-carousel-container">
                            <button class="carousel-btn prev" onclick="slideWorksCarousel('steady', -1)">‹</button>
                            <div class="works-carousel" id="steadyWorksCarousel">
                                <!-- 작품들이 동적으로 로드됩니다 -->
                            </div>
                            <button class="carousel-btn next" onclick="slideWorksCarousel('steady', 1)">›</button>
                        </div>
                    </section>
                </div>

                <!-- 탐색 페이지 -->
                <div id="explorePage" class="page">
                    <div class="explore-container">
                        <div class="explore-header">
                            <h1>🔍 작품 탐색</h1>
                        </div>

                        <div class="explore-filters">
                            <div class="filter-row">
                                <div class="category-filters">
                                    <button class="filter-btn active" onclick="filterByCategory('all')" data-category="all">전체</button>
                                    <button class="filter-btn" onclick="filterByCategory('illustration')" data-category="illustration">일러스트</button>
                                    <button class="filter-btn" onclick="filterByCategory('animation')" data-category="animation">애니메이션</button>
                                    <button class="filter-btn" onclick="filterByCategory('novel')" data-category="novel">소설</button>
                                    <button class="filter-btn" onclick="filterByCategory('manga')" data-category="manga">만화</button>
                                </div>
                                
                                <div class="sort-options">
                                    <select class="sort-select" onchange="sortWorks(this.value)">
                                        <option value="popular">인기순</option>
                                        <option value="latest">최신순</option>
                                        <option value="trending">트렌딩</option>
                                        <option value="views">조회수순</option>
                                    </select>
                                </div>
                            </div>
                        </div>

                        <div class="explore-results">
                            <div class="works-grid" id="exploreResults">
                                <!-- 검색 결과가 여기에 표시됩니다 -->
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 커뮤니티 페이지 - 네이버 밴드 스타일 -->
                <div id="communityPage" class="page">
                    <div class="community-main">
                        <div class="community-header">
                            <h1>👥 커뮤니티</h1>
                            <button class="create-community-btn" onclick="openCreateCommunityModal()">
                                <span class="icon">➕</span>커뮤니티 만들기
                            </button>
                        </div>

                        <div class="community-filters">
                            <button class="community-filter active" onclick="filterCommunities('all')" data-filter="all">전체</button>
                            <button class="community-filter" onclick="filterCommunities('animation')" data-filter="animation">애니메이션</button>
                            <button class="community-filter" onclick="filterCommunities('illustration')" data-filter="illustration">일러스트</button>
                            <button class="community-filter" onclick="filterCommunities('novel')" data-filter="novel">소설</button>
                            <button class="community-filter" onclick="filterCommunities('manga')" data-filter="manga">만화</button>
                        </div>

                        <div class="communities-grid" id="communitiesList">
                            <!-- 커뮤니티 목록이 여기에 표시됩니다 -->
                        </div>
                    </div>
                </div>

                <!-- 커뮤니티 상세 페이지 -->
                <div id="communityDetailPage" class="page">
                    <div class="community-detail">
                        <div class="community-detail-header">
                            <button class="back-btn" onclick="navigateTo('community')">← 뒤로가기</button>
                            <div class="community-info">
                                <div class="community-avatar" id="currentCommunityAvatar">🎨</div>
                                <div class="community-meta">
                                    <h1 id="currentCommunityName">커뮤니티명</h1>
                                    <div class="community-stats">
                                        <span id="currentCommunityMembers">0명</span>
                                        <span class="separator">•</span>
                                        <span id="currentCommunityPosts">게시물 0개</span>
                                    </div>
                                </div>
                            </div>
                            <div class="community-actions">
                                <button class="join-btn" id="joinBtn" onclick="toggleJoinCommunity()">참여하기</button>
                                <button class="share-btn" onclick="shareCommunity()">공유</button>
                            </div>
                        </div>

                        <div class="community-tabs">
                            <button class="community-tab active" onclick="switchCommunityTab('posts')" data-tab="posts">📝 게시물</button>
                            <button class="community-tab" onclick="switchCommunityTab('members')" data-tab="members">👥 멤버</button>
                            <button class="community-tab" onclick="switchCommunityTab('about')" data-tab="about">ℹ️ 정보</button>
                        </div>

                        <div class="community-content">
                            <div id="communityPosts" class="community-tab-content active">
                                <div class="post-create-section">
                                    <button class="create-post-btn" onclick="openCreatePostModal()">
                                        <span class="icon">✏️</span>게시물 작성하기
                                    </button>
                                </div>
                                <div class="posts-list" id="communityPostsList">
                                    <!-- 게시물들이 여기에 표시됩니다 -->
                                </div>
                            </div>
                            
                            <div id="communityMembers" class="community-tab-content">
                                <div class="members-list" id="communityMembersList">
                                    <!-- 멤버들이 여기에 표시됩니다 -->
                                </div>
                            </div>
                            
                            <div id="communityAbout" class="community-tab-content">
                                <div class="about-content" id="communityAboutContent">
                                    <!-- 커뮤니티 정보가 여기에 표시됩니다 -->
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 메시지 페이지 - 카카오톡 스타일 -->
                <div id="messagesPage" class="page">
                    <div class="messages-layout">
                        <div class="chat-sidebar">
                            <div class="chat-header">
                                <h2>💬 채팅</h2>
                                <div class="chat-header-actions">
                                    <button class="chat-action-btn" onclick="openNewChatModal()" title="새 채팅">✏️</button>
                                    <button class="chat-action-btn" onclick="openGroupChatModal()" title="단체채팅">👥</button>
                                </div>
                            </div>
                            
                            <div class="chat-search-container">
                                <div class="chat-search">
                                    <span class="search-icon">🔍</span>
                                    <input type="text" placeholder="채팅방, 이름 검색" id="chatSearchInput" oninput="searchChats()">
                                </div>
                            </div>
                            
                            <div class="chat-tabs">
                                <button class="chat-tab active" onclick="switchChatTab('all')" data-tab="all">전체</button>
                                <button class="chat-tab" onclick="switchChatTab('unread')" data-tab="unread">안읽음</button>
                                <button class="chat-tab" onclick="switchChatTab('favorites')" data-tab="favorites">즐겨찾기</button>
                            </div>
                            
                            <div class="chat-rooms-list" id="chatRoomsList">
                                <!-- 채팅방 목록이 여기에 표시됩니다 -->
                            </div>
                        </div>
                        
                        <div class="chat-main" id="chatMain">
                            <div class="chat-welcome">
                                <div class="welcome-icon">💬</div>
                                <h3>채팅을 시작해보세요!</h3>
                                <p>친구들과 실시간으로 소통하고 아이디어를 나눠보세요</p>
                                <button class="start-chat-btn" onclick="openNewChatModal()">새 채팅 시작하기</button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 프로필 페이지 -->
                <div id="profilePage" class="page">
                    <div class="profile-container">
                        <div class="profile-header">
                            <div class="profile-cover"></div>
                            <div class="profile-info">
                                <div class="profile-avatar" id="profileAvatar">U</div>
                                <div class="profile-details">
                                    <h1 id="profileName">사용자</h1>
                                    <p class="profile-handle" id="profileHandle">@username</p>
                                    <p class="profile-bio" id="profileBio">안녕하세요! 창작자입니다.</p>
                                    
                                    <div class="profile-stats">
                                        <div class="stat">
                                            <span class="stat-number" id="statsWorks">0</span>
                                            <span class="stat-label">작품</span>
                                        </div>
                                        <div class="stat">
                                            <span class="stat-number" id="statsFollowers">0</span>
                                            <span class="stat-label">팔로워</span>
                                        </div>
                                        <div class="stat">
                                            <span class="stat-number" id="statsFollowing">0</span>
                                            <span class="stat-label">팔로잉</span>
                                        </div>
                                        <div class="stat">
                                            <span class="stat-number" id="statsViews">0</span>
                                            <span class="stat-label">조회수</span>
                                        </div>
                                    </div>
                                    
                                    <div class="profile-actions">
                                        <button class="profile-btn primary" onclick="editProfile()">프로필 편집</button>
                                        <button class="profile-btn secondary" onclick="shareProfile()">공유</button>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="profile-tabs">
                            <button class="profile-tab active" onclick="switchProfileTab('overview')" data-tab="overview">개요</button>
                            <button class="profile-tab" onclick="switchProfileTab('works')" data-tab="works">작품</button>
                            <button class="profile-tab" onclick="switchProfileTab('collections')" data-tab="collections">컬렉션</button>
                            <button class="profile-tab" onclick="switchProfileTab('communities')" data-tab="communities">커뮤니티</button>
                            <button class="profile-tab" onclick="switchProfileTab('analytics')" data-tab="analytics">분석</button>
                        </div>

                        <div class="profile-content">
                            <div id="profileOverview" class="profile-tab-content active">
                                <div class="overview-grid">
                                    <div class="recent-activity">
                                        <h3>최근 활동</h3>
                                        <div class="activity-list" id="recentActivity"></div>
                                    </div>
                                    <div class="popular-works">
                                        <h3>인기 작품</h3>
                                        <div class="works-list" id="popularWorks"></div>
                                    </div>
                                </div>
                            </div>
                            
                            <div id="profileWorks" class="profile-tab-content">
                                <div class="works-grid" id="userWorksGrid"></div>
                            </div>
                            
                            <div id="profileCollections" class="profile-tab-content">
                                <div class="collections-grid" id="collectionsGrid"></div>
                            </div>
                            
                            <div id="profileCommunities" class="profile-tab-content">
                                <div class="joined-communities" id="joinedCommunities"></div>
                            </div>
                            
                            <div id="profileAnalytics" class="profile-tab-content">
                                <div class="analytics-dashboard">
                                    <div class="analytics-cards">
                                        <div class="analytics-card">
                                            <h4>이번 달 조회수</h4>
                                            <div class="analytics-number">1,234</div>
                                            <div class="analytics-change positive">+15.3%</div>
                                        </div>
                                        <div class="analytics-card">
                                            <h4>새 팔로워</h4>
                                            <div class="analytics-number">89</div>
                                            <div class="analytics-change positive">+8.2%</div>
                                        </div>
                                        <div class="analytics-card">
                                            <h4>작품 좋아요</h4>
                                            <div class="analytics-number">456</div>
                                            <div class="analytics-change positive">+12.7%</div>
                                        </div>
                                        <div class="analytics-card">
                                            <h4>수익</h4>
                                            <div class="analytics-number">₩127,000</div>
                                            <div class="analytics-change positive">+23.1%</div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 작품 업로드 페이지 - 새로운 페이지 형태 -->
                <div id="uploadPage" class="page">
                    <div class="upload-container">
                        <!-- 상단 툴바 -->
                        <div class="upload-toolbar">
                            <div class="toolbar-left">
                                <button class="toolbar-btn back-btn" onclick="navigateBack()">
                                    <span class="icon">←</span>뒤로
                                </button>
                                <div class="toolbar-divider"></div>
                                <h1 class="page-title">작품 업로드</h1>
                            </div>
                            
                            <div class="toolbar-center">
                                <div class="upload-steps-indicator">
                                    <div class="step-item active" data-step="1">
                                        <span class="step-number">1</span>
                                        <span class="step-label">파일 선택</span>
                                    </div>
                                    <div class="step-item" data-step="2">
                                        <span class="step-number">2</span>
                                        <span class="step-label">작품 정보</span>
                                    </div>
                                    <div class="step-item" data-step="3">
                                        <span class="step-number">3</span>
                                        <span class="step-label">게시 설정</span>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="toolbar-right">
                                <button class="toolbar-btn save-draft" onclick="saveDraft()">임시저장</button>
                                <button class="toolbar-btn primary" id="publishBtn" onclick="publishWork()">게시하기</button>
                            </div>
                        </div>

                        <!-- 업로드 콘텐츠 영역 -->
                        <div class="upload-content">
                            <!-- 1단계: 파일 선택 -->
                            <div id="uploadStep1" class="upload-step active">
                                <div class="upload-area">
                                    <div class="file-drop-zone" onclick="document.getElementById('fileInput').click()">
                                        <div class="drop-content">
                                            <div class="drop-icon">📁</div>
                                            <h3>파일을 선택하거나 여기에 드래그하세요</h3>
                                            <p>이미지, 동영상, 문서 파일을 지원합니다 (최대 100MB)</p>
                                            <button class="select-file-btn">파일 선택하기</button>
                                        </div>
                                        <input type="file" id="fileInput" accept="image/*,video/*,.pdf,.doc,.docx,.txt" 
                                               onchange="handleFileUpload(event)" style="display: none;">
                                    </div>
                                    
                                    <div id="filePreview" class="file-preview-area">
                                        <!-- 파일 미리보기가 여기에 표시됩니다 -->
                                    </div>
                                </div>
                                
                                <div class="upload-tips">
                                    <h4>💡 업로드 팁</h4>
                                    <ul>
                                        <li>고화질 이미지일수록 더 많은 관심을 받아요</li>
                                        <li>썸네일이 될 첫 번째 이미지를 신중히 선택하세요</li>
                                        <li>시리즈 작품은 폴더별로 정리해서 올려보세요</li>
                                    </ul>
                                </div>
                            </div>

                            <!-- 2단계: 작품 정보 -->
                            <div id="uploadStep2" class="upload-step">
                                <div class="form-layout">
                                    <div class="form-main">
                                        <div class="form-section">
                                            <h3>기본 정보</h3>
                                            <div class="form-row">
                                                <div class="form-group">
                                                    <label>작품 제목 *</label>
                                                    <input type="text" id="workTitle" placeholder="멋진 작품 제목을 입력하세요" maxlength="100">
                                                    <div class="char-counter">0/100</div>
                                                </div>
                                            </div>
                                            
                                            <div class="form-row">
                                                <div class="form-group">
                                                    <label>작품 설명</label>
                                                    <div class="editor-container">
                                                        <div class="editor-toolbar">
                                                            <button type="button" class="editor-btn" onclick="formatText('bold')"><b>B</b></button>
                                                            <button type="button" class="editor-btn" onclick="formatText('italic')"><i>I</i></button>
                                                            <button type="button" class="editor-btn" onclick="formatText('underline')"><u>U</u></button>
                                                            <div class="toolbar-divider"></div>
                                                            <button type="button" class="editor-btn" onclick="insertEmoji()">😊</button>
                                                            <button type="button" class="editor-btn" onclick="insertLink()">🔗</button>
                                                        </div>
                                                        <textarea id="workDescription" placeholder="작품에 대한 설명을 입력하세요..." rows="6"></textarea>
                                                    </div>
                                                    <div class="char-counter">0/1000</div>
                                                </div>
                                            </div>
                                        </div>
                                        
                                        <div class="form-section">
                                            <h3>카테고리 및 태그</h3>
                                            <div class="form-row">
                                                <div class="form-group half">
                                                    <label>카테고리 *</label>
                                                    <select id="workCategory">
                                                        <option value="">선택하세요</option>
                                                        <option value="illustration">🎨 일러스트</option>
                                                        <option value="animation">🎬 애니메이션</option>
                                                        <option value="novel">📚 소설</option>
                                                        <option value="manga">📖 만화</option>
                                                        <option value="music">🎵 음악</option>
                                                        <option value="game">🎮 게임</option>
                                                    </select>
                                                </div>
                                                <div class="form-group half">
                                                    <label>연령 등급</label>
                                                    <select id="ageRating">
                                                        <option value="all">전체 이용가</option>
                                                        <option value="teen">청소년 이상</option>
                                                        <option value="adult">성인 이용</option>
                                                    </select>
                                                </div>
                                            </div>
                                            
                                            <div class="form-row">
                                                <div class="form-group">
                                                    <label>태그</label>
                                                    <div class="tag-input-container">
                                                        <input type="text" id="tagInput" placeholder="태그를 입력하고 Enter를 누르세요" onkeypress="handleTagInput(event)">
                                                        <div class="tag-list" id="tagList"></div>
                                                    </div>
                                                    <div class="tag-suggestions">
                                                        <span class="suggestion-tag" onclick="addTag('하이큐')">#하이큐</span>
                                                        <span class="suggestion-tag" onclick="addTag('팬아트')">#팬아트</span>
                                                        <span class="suggestion-tag" onclick="addTag('일러스트')">#일러스트</span>
                                                        <span class="suggestion-tag" onclick="addTag('애니메이션')">#애니메이션</span>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <div class="form-sidebar">
                                        <div class="preview-card">
                                            <h4>미리보기</h4>
                                            <div class="work-preview" id="workPreview">
                                                <div class="preview-thumbnail">🎨</div>
                                                <div class="preview-content">
                                                    <h5 class="preview-title">제목을 입력하세요</h5>
                                                    <p class="preview-author">작성자: 당신</p>
                                                    <div class="preview-tags"></div>
                                                </div>
                                            </div>
                                        </div>
                                        
                                        <div class="help-card">
                                            <h4>📝 작성 가이드</h4>
                                            <ul>
                                                <li>제목은 간결하고 매력적으로</li>
                                                <li>설명은 작품의 스토리나 제작 과정을 포함</li>
                                                <li>적절한 태그로 노출도 증가</li>
                                                <li>저작권을 준수해주세요</li>
                                            </ul>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- 3단계: 게시 설정 -->
                            <div id="uploadStep3" class="upload-step">
                                <div class="settings-layout">
                                    <div class="settings-main">
                                        <div class="settings-section">
                                            <h3>공개 설정</h3>
                                            <div class="radio-group">
                                                <label class="radio-option">
                                                    <input type="radio" name="visibility" value="public" checked>
                                                    <span class="radio-indicator"></span>
                                                    <div class="option-content">
                                                        <strong>공개</strong>
                                                        <p>누구나 볼 수 있고 검색 결과에 표시됩니다</p>
                                                    </div>
                                                </label>
                                                <label class="radio-option">
                                                    <input type="radio" name="visibility" value="unlisted">
                                                    <span class="radio-indicator"></span>
                                                    <div class="option-content">
                                                        <strong>링크만 공개</strong>
                                                        <p>링크를 아는 사람만 볼 수 있습니다</p>
                                                    </div>
                                                </label>
                                                <label class="radio-option">
                                                    <input type="radio" name="visibility" value="private">
                                                    <span class="radio-indicator"></span>
                                                    <div class="option-content">
                                                        <strong>비공개</strong>
                                                        <p>나만 볼 수 있습니다</p>
                                                    </div>
                                                </label>
                                            </div>
                                        </div>
                                        
                                        <div class="settings-section">
                                            <h3>상호작용 설정</h3>
                                            <div class="toggle-group">
                                                <label class="toggle-option">
                                                    <input type="checkbox" id="allowComments" checked>
                                                    <span class="toggle-switch"></span>
                                                    <div class="option-content">
                                                        <strong>댓글 허용</strong>
                                                        <p>다른 사용자가 댓글을 달 수 있습니다</p>
                                                    </div>
                                                </label>
                                                <label class="toggle-option">
                                                    <input type="checkbox" id="allowLikes" checked>
                                                    <span class="toggle-switch"></span>
                                                    <div class="option-content">
                                                        <strong>좋아요 허용</strong>
                                                        <p>다른 사용자가 좋아요를 누를 수 있습니다</p>
                                                    </div>
                                                </label>
                                                <label class="toggle-option">
                                                    <input type="checkbox" id="allowDownload">
                                                    <span class="toggle-switch"></span>
                                                    <div class="option-content">
                                                        <strong>다운로드 허용</strong>
                                                        <p>다른 사용자가 작품을 다운로드할 수 있습니다</p>
                                                    </div>
                                                </label>
                                            </div>
                                        </div>
                                        
                                        <div class="settings-section">
                                            <h3>게시 일정</h3>
                                            <div class="radio-group">
                                                <label class="radio-option">
                                                    <input type="radio" name="publishSchedule" value="now" checked>
                                                    <span class="radio-indicator"></span>
                                                    <div class="option-content">
                                                        <strong>지금 게시</strong>
                                                        <p>즉시 게시됩니다</p>
                                                    </div>
                                                </label>
                                                <label class="radio-option">
                                                    <input type="radio" name="publishSchedule" value="scheduled">
                                                    <span class="radio-indicator"></span>
                                                    <div class="option-content">
                                                        <strong>예약 게시</strong>
                                                        <p>원하는 시간에 자동으로 게시됩니다</p>
                                                    </div>
                                                </label>
                                            </div>
                                            <div id="scheduleSettings" class="schedule-settings" style="display: none;">
                                                <input type="datetime-local" id="publishDateTime">
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <div class="settings-sidebar">
                                        <div class="final-preview">
                                            <h4>최종 미리보기</h4>
                                            <div class="work-card-preview" id="finalPreview">
                                                <!-- 최종 미리보기 -->
                                            </div>
                                        </div>
                                        
                                        <div class="publish-info">
                                            <h4>🚀 게시 준비</h4>
                                            <div class="checklist">
                                                <div class="checklist-item" id="checkTitle">
                                                    <span class="check-icon">⏳</span>제목 입력
                                                </div>
                                                <div class="checklist-item" id="checkFile">
                                                    <span class="check-icon">⏳</span>파일 업로드
                                                </div>
                                                <div class="checklist-item" id="checkCategory">
                                                    <span class="check-icon">⏳</span>카테고리 선택
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- 하단 네비게이션 -->
                        <div class="upload-navigation">
                            <button class="nav-btn secondary" id="prevStepBtn" onclick="previousUploadStep()" style="display: none;">
                                <span class="icon">←</span>이전
                            </button>
                            <div class="nav-center">
                                <div class="progress-bar">
                                    <div class="progress-fill" id="uploadProgressBar"></div>
                                </div>
                                <span class="progress-text" id="uploadProgressText">1/3 단계</span>
                            </div>
                            <button class="nav-btn primary" id="nextStepBtn" onclick="nextUploadStep()">
                                다음<span class="icon">→</span>
                            </button>
                        </div>
                    </div>
                </div>
            </main>
        </div>
    </div>

    <!-- 모달들 -->
    <!-- 커뮤니티 생성 모달 -->
    <div id="createCommunityModal" class="modal-overlay" style="display: none;">
        <div class="modal-container community-modal">
            <div class="modal-header">
                <h2>새 커뮤니티 만들기</h2>
                <button class="modal-close" onclick="closeModal('createCommunityModal')">×</button>
            </div>
            <div class="modal-content">
                <div class="form-group">
                    <label>커뮤니티 이미지</label>
                    <div class="image-upload" onclick="document.getElementById('communityImageInput').click()">
                        <div class="upload-placeholder">
                            <span class="upload-icon">📸</span>
                            <span>이미지 추가</span>
                        </div>
                        <input type="file" id="communityImageInput" accept="image/*" style="display: none;">
                    </div>
                </div>
                <div class="form-group">
                    <label>커뮤니티 이름 *</label>
                    <input type="text" id="communityName" placeholder="커뮤니티 이름을 입력하세요">
                </div>
                <div class="form-group">
                    <label>카테고리 *</label>
                    <select id="communityCategory">
                        <option value="">선택하세요</option>
                        <option value="animation">애니메이션</option>
                        <option value="illustration">일러스트</option>
                        <option value="novel">소설</option>
                        <option value="manga">만화</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>커뮤니티 소개</label>
                    <textarea id="communityDescription" placeholder="커뮤니티에 대해 소개해주세요" rows="3"></textarea>
                </div>
                <div class="form-group">
                    <label>공개 설정</label>
                    <div class="radio-group">
                        <label class="radio-option">
                            <input type="radio" name="communityPrivacy" value="public" checked>
                            <span class="radio-indicator"></span>
                            <div class="option-content">
                                <strong>공개</strong>
                                <small>누구나 참여할 수 있습니다</small>
                            </div>
                        </label>
                        <label class="radio-option">
                            <input type="radio" name="communityPrivacy" value="private">
                            <span class="radio-indicator"></span>
                            <div class="option-content">
                                <strong>비공개</strong>
                                <small>승인 후 참여할 수 있습니다</small>
                            </div>
                        </label>
                    </div>
                </div>
            </div>
            <div class="modal-actions">
                <button class="modal-btn secondary" onclick="closeModal('createCommunityModal')">취소</button>
                <button class="modal-btn primary" onclick="createCommunity()">만들기</button>
            </div>
        </div>
    </div>

    <!-- Firebase 스크립트 -->
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
        import { getAuth, createUserWithEmailAndPassword, signInWithEmailAndPassword, GoogleAuthProvider, signInWithPopup, onAuthStateChanged, signOut, updateProfile } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";
        import { getFirestore, collection, addDoc, getDocs, doc, setDoc, serverTimestamp, query, orderBy, where, onSnapshot, updateDoc, increment } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";
        import { getStorage, ref, uploadBytes, getDownloadURL } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-storage.js";

        const firebaseConfig = {
            apiKey: "AIzaSyAYrLmXnpMPd0FjGQ-3_IXBF_ZqGV-mOk8",
            authDomain: "creta-30c69.firebaseapp.com",
            projectId: "creta-30c69",
            storageBucket: "creta-30c69.firebasestorage.app",
            messagingSenderId: "126716257571",
            appId: "1:126716257571:web:33dfd5dbd1bcdb7a229896"
        };

        const app = initializeApp(firebaseConfig);
        window.auth = getAuth(app);
        window.db = getFirestore(app);
        window.storage = getStorage(app);
        window.firebaseModules = {
            createUserWithEmailAndPassword, signInWithEmailAndPassword, GoogleAuthProvider,
            signInWithPopup, onAuthStateChanged, signOut, updateProfile, collection, addDoc,
            getDocs, doc, setDoc, serverTimestamp, query, orderBy, where, onSnapshot,
            updateDoc, increment, ref, uploadBytes, getDownloadURL
        };

        setTimeout(() => {
            document.getElementById('loadingScreen').style.display = 'none';
        }, 2000);

        onAuthStateChanged(window.auth, (user) => {
            if (user) {
                window.currentUser = user;
                window.showMainApp && window.showMainApp();
            } else {
                window.showAuthModal && window.showAuthModal();
            }
        });
    </script>

    <script src="script.js"></script>
</body>
</html>
