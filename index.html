<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CRETA - 창작자를 위한 플랫폼</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Pretendard:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <script src="https://developers.kakao.com/sdk/js/kakao.js"></script>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <!-- 로딩 화면 -->
    <div id="loadingScreen" class="loading-screen">
        <div class="loading-content">
            <div class="logo">
                <span class="logo-icon">🎨</span>
                <span class="logo-text">CRETA</span>
            </div>
            <div class="loading-spinner"></div>
            <p>창작의 세계로 입장 중...</p>
        </div>
    </div>

    <!-- 인증 모달 -->
    <div id="authModal" class="modal-overlay" style="display: none;">
        <div class="auth-modal">
            <button class="modal-close" onclick="closeModal('authModal')">×</button>
            
            <div class="auth-header">
                <div class="logo">
                    <span class="logo-icon">🎨</span>
                    <span class="logo-text">CRETA</span>
                </div>
                <p>창작자들의 플랫폼에 오신 것을 환영합니다</p>
            </div>

            <div class="auth-tabs">
                <button class="auth-tab active" onclick="switchAuthTab('login')">로그인</button>
                <button class="auth-tab" onclick="switchAuthTab('signup')">회원가입</button>
            </div>

            <!-- 로그인 폼 -->
            <div id="loginForm" class="auth-form">
                <input type="email" id="loginEmail" placeholder="이메일" class="auth-input">
                <input type="password" id="loginPassword" placeholder="비밀번호" class="auth-input">
                
                <div class="auth-options">
                    <label class="checkbox-label">
                        <input type="checkbox" id="rememberMe">
                        <span>로그인 상태 유지</span>
                    </label>
                    <a href="#" class="forgot-link">비밀번호 찾기</a>
                </div>

                <button class="auth-btn primary" onclick="loginUser()">로그인</button>
                
                <div class="social-divider">
                    <span>또는 간편 로그인</span>
                </div>

                <div class="social-buttons">
                    <button class="social-btn google" onclick="socialLogin('google')">
                        <span class="social-icon">G</span>구글
                    </button>
                    <button class="social-btn kakao" onclick="socialLogin('kakao')">
                        <span class="social-icon">K</span>카카오
                    </button>
                    <button class="social-btn naver" onclick="socialLogin('naver')">
                        <span class="social-icon">N</span>네이버
                    </button>
                    <button class="social-btn twitter" onclick="socialLogin('twitter')">
                        <span class="social-icon">T</span>트위터
                    </button>
                </div>
            </div>

            <!-- 회원가입 폼 -->
            <div id="signupForm" class="auth-form" style="display: none;">
                <input type="text" id="signupName" placeholder="닉네임" class="auth-input">
                <input type="email" id="signupEmail" placeholder="이메일" class="auth-input">
                <input type="password" id="signupPassword" placeholder="비밀번호 (8자 이상)" class="auth-input">
                <input type="password" id="signupPasswordConfirm" placeholder="비밀번호 확인" class="auth-input">
                
                <label class="checkbox-label">
                    <input type="checkbox" id="agreeTerms">
                    <span>이용약관 및 개인정보처리방침에 동의합니다</span>
                </label>

                <button class="auth-btn primary" onclick="signupUser()">회원가입</button>
                
                <div class="social-divider">
                    <span>또는 간편 가입</span>
                </div>

                <div class="social-buttons">
                    <button class="social-btn google" onclick="socialSignup('google')">
                        <span class="social-icon">G</span>구글
                    </button>
                    <button class="social-btn kakao" onclick="socialSignup('kakao')">
                        <span class="social-icon">K</span>카카오
                    </button>
                    <button class="social-btn naver" onclick="socialSignup('naver')">
                        <span class="social-icon">N</span>네이버
                    </button>
                    <button class="social-btn twitter" onclick="socialSignup('twitter')">
                        <span class="social-icon">T</span>트위터
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- 메인 앱 -->
    <div id="mainApp" class="main-app" style="display: none;">
        <!-- 헤더 -->
        <header class="app-header">
            <div class="header-content">
                <div class="logo">
                    <span class="logo-icon">🎨</span>
                    <span class="logo-text">CRETA</span>
                </div>
                
                <div class="header-actions">
                    <button class="header-btn" onclick="openNotifications()">
                        <span class="icon">🔔</span>
                        <span class="badge">3</span>
                    </button>
                    <div class="user-profile" onclick="goToProfile()">
                        <span id="userInitial">U</span>
                    </div>
                    <button class="header-btn logout" onclick="logoutUser()" style="display: none;">
                        로그아웃
                    </button>
                </div>
            </div>
        </header>

        <div class="app-body">
            <!-- 사이드바 -->
            <nav class="sidebar">
                <div class="nav-items">
                    <button class="nav-item active" onclick="navigateTo('home')" data-page="home">
                        <span class="nav-icon">🏠</span>
                        <span class="nav-text">홈</span>
                    </button>
                    <button class="nav-item" onclick="navigateTo('explore')" data-page="explore">
                        <span class="nav-icon">🔍</span>
                        <span class="nav-text">탐색</span>
                    </button>
                    <button class="nav-item" onclick="navigateTo('community')" data-page="community">
                        <span class="nav-icon">👥</span>
                        <span class="nav-text">커뮤니티</span>
                    </button>
                    <button class="nav-item" onclick="navigateTo('messages')" data-page="messages">
                        <span class="nav-icon">💬</span>
                        <span class="nav-text">메시지</span>
                        <span class="nav-badge">2</span>
                    </button>
                    <button class="nav-item" onclick="navigateTo('profile')" data-page="profile">
                        <span class="nav-icon">👤</span>
                        <span class="nav-text">프로필</span>
                    </button>
                    
                    <div class="nav-divider"></div>
                    
                    <button class="nav-item upload" onclick="openUploadModal()">
                        <span class="nav-icon">➕</span>
                        <span class="nav-text">작품 업로드</span>
                    </button>
                </div>
            </nav>

            <!-- 메인 콘텐츠 -->
            <main class="main-content">
                <!-- 홈 페이지 -->
                <div id="homePage" class="page active">
                    <div class="welcome-banner">
                        <h1>안녕하세요, <span id="welcomeName">창작자</span>님! 🎨</h1>
                        <p>CRETA에서 여러분의 창작 여정을 시작해보세요</p>
                    </div>

                    <section class="content-section">
                        <div class="section-header">
                            <h2>🔥 최신 업로드 작품</h2>
                            <button class="see-more-btn" onclick="navigateTo('explore')">더보기</button>
                        </div>
                        <div class="works-grid" id="latestWorks">
                            <!-- 작품들이 동적으로 로드됩니다 -->
                        </div>
                    </section>

                    <section class="content-section">
                        <div class="section-header">
                            <h2>📈 인기 급상승</h2>
                            <button class="see-more-btn" onclick="navigateTo('explore')">더보기</button>
                        </div>
                        <div class="works-grid" id="trendingWorks">
                            <!-- 작품들이 동적으로 로드됩니다 -->
                        </div>
                    </section>

                    <section class="content-section">
                        <div class="section-header">
                            <h2>⭐ 스테디셀러</h2>
                            <button class="see-more-btn" onclick="navigateTo('explore')">더보기</button>
                        </div>
                        <div class="works-grid" id="steadyWorks">
                            <!-- 작품들이 동적으로 로드됩니다 -->
                        </div>
                    </section>
                </div>

                <!-- 탐색 페이지 -->
                <div id="explorePage" class="page">
                    <div class="explore-header">
                        <h1>🔍 작품 탐색</h1>
                        
                        <div class="search-section">
                            <div class="search-box">
                                <input type="text" id="searchInput" placeholder="작품, 작가, 태그로 검색..." 
                                       onkeypress="handleSearch(event)" onfocus="showSearchSuggestions()">
                                <button class="search-btn" onclick="performSearch()">🔍</button>
                            </div>
                            
                            <!-- 검색 제안 패널 -->
                            <div id="searchSuggestions" class="suggestions-panel" style="display: none;">
                                <div class="suggestions-content">
                                    <div class="suggestion-section">
                                        <h4>연관 검색어</h4>
                                        <div class="suggestion-list" id="relatedKeywords">
                                            <!-- 동적 로드 -->
                                        </div>
                                    </div>
                                    <div class="suggestion-section">
                                        <h4>실시간 인기</h4>
                                        <div class="trending-list" id="trendingKeywords">
                                            <!-- 동적 로드 -->
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="filter-section">
                            <div class="category-filters">
                                <button class="filter-btn active" onclick="filterByCategory('all')">전체</button>
                                <button class="filter-btn" onclick="filterByCategory('illustration')">일러스트</button>
                                <button class="filter-btn" onclick="filterByCategory('animation')">애니메이션</button>
                                <button class="filter-btn" onclick="filterByCategory('novel')">소설</button>
                                <button class="filter-btn" onclick="filterByCategory('manga')">만화</button>
                            </div>
                            
                            <div class="sort-options">
                                <button class="sort-btn active" onclick="sortBy('popular')">인기순</button>
                                <button class="sort-btn" onclick="sortBy('latest')">최신순</button>
                                <button class="sort-btn" onclick="sortBy('trending')">트렌딩</button>
                            </div>
                        </div>
                    </div>

                    <div class="explore-results">
                        <div class="works-grid" id="exploreResults">
                            <!-- 검색 결과가 여기에 표시됩니다 -->
                        </div>
                    </div>
                </div>

                <!-- 커뮤니티 페이지 -->
                <div id="communityPage" class="page">
                    <div class="community-header">
                        <h1>👥 커뮤니티</h1>
                        <button class="create-btn" onclick="openCreateCommunityModal()">
                            <span class="icon">➕</span>커뮤니티 만들기
                        </button>
                    </div>

                    <div class="community-filters">
                        <button class="filter-btn active" onclick="filterCommunities('all')">전체</button>
                        <button class="filter-btn" onclick="filterCommunities('animation')">애니메이션</button>
                        <button class="filter-btn" onclick="filterCommunities('illustration')">일러스트</button>
                        <button class="filter-btn" onclick="filterCommunities('novel')">소설</button>
                        <button class="filter-btn" onclick="filterCommunities('manga')">만화</button>
                    </div>

                    <div class="communities-grid" id="communitiesList">
                        <!-- 커뮤니티 목록이 여기에 표시됩니다 -->
                    </div>
                </div>

                <!-- 메시지 페이지 -->
                <div id="messagesPage" class="page">
                    <div class="messages-layout">
                        <div class="chat-sidebar">
                            <div class="chat-header">
                                <h2>💬 메시지</h2>
                                <div class="chat-actions">
                                    <button class="chat-action-btn" onclick="openNewChatModal()">✏️</button>
                                    <button class="chat-action-btn" onclick="openGroupChatModal()">👥</button>
                                </div>
                            </div>
                            
                            <div class="chat-search">
                                <input type="text" placeholder="채팅방, 이름 검색" id="chatSearch">
                            </div>
                            
                            <div class="chat-tabs">
                                <button class="chat-tab active" onclick="switchChatTab('all')">전체</button>
                                <button class="chat-tab" onclick="switchChatTab('unread')">안읽음</button>
                                <button class="chat-tab" onclick="switchChatTab('favorites')">즐겨찾기</button>
                            </div>
                            
                            <div class="chat-rooms" id="chatRoomsList">
                                <!-- 채팅방 목록 -->
                            </div>
                        </div>
                        
                        <div class="chat-main" id="chatMain">
                            <div class="chat-welcome">
                                <div class="welcome-icon">💬</div>
                                <h3>채팅을 시작해보세요!</h3>
                                <p>친구들과 실시간으로 소통하고 아이디어를 나눠보세요</p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 프로필 페이지 -->
                <div id="profilePage" class="page">
                    <div class="profile-container">
                        <!-- 프로필 헤더 -->
                        <div class="profile-header">
                            <div class="profile-cover"></div>
                            <div class="profile-info">
                                <div class="profile-avatar" id="profileAvatar">U</div>
                                <div class="profile-details">
                                    <h1 id="profileName">사용자</h1>
                                    <p class="profile-handle" id="profileHandle">@username</p>
                                    <p class="profile-bio" id="profileBio">안녕하세요! 창작자입니다.</p>
                                    
                                    <div class="profile-stats">
                                        <div class="stat">
                                            <span class="stat-number" id="statsWorks">0</span>
                                            <span class="stat-label">작품</span>
                                        </div>
                                        <div class="stat">
                                            <span class="stat-number" id="statsFollowers">0</span>
                                            <span class="stat-label">팔로워</span>
                                        </div>
                                        <div class="stat">
                                            <span class="stat-number" id="statsFollowing">0</span>
                                            <span class="stat-label">팔로잉</span>
                                        </div>
                                        <div class="stat">
                                            <span class="stat-number" id="statsViews">0</span>
                                            <span class="stat-label">조회수</span>
                                        </div>
                                    </div>
                                    
                                    <div class="profile-actions">
                                        <button class="profile-btn primary" onclick="editProfile()">프로필 편집</button>
                                        <button class="profile-btn secondary" onclick="shareProfile()">공유</button>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- 프로필 탭 -->
                        <div class="profile-tabs">
                            <button class="profile-tab active" onclick="switchProfileTab('overview')">개요</button>
                            <button class="profile-tab" onclick="switchProfileTab('works')">작품</button>
                            <button class="profile-tab" onclick="switchProfileTab('collections')">컬렉션</button>
                            <button class="profile-tab" onclick="switchProfileTab('communities')">커뮤니티</button>
                            <button class="profile-tab" onclick="switchProfileTab('analytics')">분석</button>
                            <button class="profile-tab" onclick="switchProfileTab('settings')">설정</button>
                        </div>

                        <!-- 프로필 탭 콘텐츠 -->
                        <div class="profile-content">
                            <div id="profileOverview" class="profile-tab-content active">
                                <div class="overview-grid">
                                    <div class="recent-activity">
                                        <h3>최근 활동</h3>
                                        <div class="activity-list" id="recentActivity">
                                            <!-- 최근 활동 내역 -->
                                        </div>
                                    </div>
                                    <div class="popular-works">
                                        <h3>인기 작품</h3>
                                        <div class="works-list" id="popularWorks">
                                            <!-- 인기 작품 목록 -->
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <div id="profileWorks" class="profile-tab-content">
                                <div class="works-header">
                                    <div class="works-filters">
                                        <button class="filter-btn active" onclick="filterUserWorks('all')">전체</button>
                                        <button class="filter-btn" onclick="filterUserWorks('illustration')">일러스트</button>
                                        <button class="filter-btn" onclick="filterUserWorks('animation')">애니메이션</button>
                                        <button class="filter-btn" onclick="filterUserWorks('novel')">소설</button>
                                    </div>
                                </div>
                                <div class="user-works-grid" id="userWorksGrid">
                                    <!-- 사용자 작품들 -->
                                </div>
                            </div>
                            
                            <div id="profileCollections" class="profile-tab-content">
                                <div class="collections-header">
                                    <h3>내 컬렉션</h3>
                                    <button class="create-btn" onclick="createCollection()">컬렉션 만들기</button>
                                </div>
                                <div class="collections-grid" id="collectionsGrid">
                                    <!-- 컬렉션들 -->
                                </div>
                            </div>
                            
                            <div id="profileCommunities" class="profile-tab-content">
                                <div class="joined-communities" id="joinedCommunities">
                                    <!-- 참여한 커뮤니티들 -->
                                </div>
                            </div>
                            
                            <div id="profileAnalytics" class="profile-tab-content">
                                <div class="analytics-dashboard">
                                    <div class="analytics-cards">
                                        <div class="analytics-card">
                                            <h4>이번 달 조회수</h4>
                                            <div class="analytics-number">1,234</div>
                                            <div class="analytics-change positive">+15.3%</div>
                                        </div>
                                        <div class="analytics-card">
                                            <h4>새 팔로워</h4>
                                            <div class="analytics-number">89</div>
                                            <div class="analytics-change positive">+8.2%</div>
                                        </div>
                                        <div class="analytics-card">
                                            <h4>작품 좋아요</h4>
                                            <div class="analytics-number">456</div>
                                            <div class="analytics-change positive">+12.7%</div>
                                        </div>
                                        <div class="analytics-card">
                                            <h4>수익</h4>
                                            <div class="analytics-number">₩127,000</div>
                                            <div class="analytics-change positive">+23.1%</div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <div id="profileSettings" class="profile-tab-content">
                                <div class="settings-sections">
                                    <div class="settings-section">
                                        <h4>계정 설정</h4>
                                        <div class="settings-items">
                                            <div class="setting-item">
                                                <span>이메일</span>
                                                <span id="settingsEmail">user@example.com</span>
                                            </div>
                                            <div class="setting-item">
                                                <span>비밀번호</span>
                                                <button class="setting-action">변경</button>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="settings-section">
                                        <h4>알림 설정</h4>
                                        <div class="settings-items">
                                            <div class="setting-item">
                                                <span>이메일 알림</span>
                                                <label class="toggle">
                                                    <input type="checkbox" checked>
                                                    <span class="toggle-slider"></span>
                                                </label>
                                            </div>
                                            <div class="setting-item">
                                                <span>푸시 알림</span>
                                                <label class="toggle">
                                                    <input type="checkbox" checked>
                                                    <span class="toggle-slider"></span>
                                                </label>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </main>
        </div>
    </div>

    <!-- 작품 업로드 모달 -->
    <div id="uploadModal" class="modal-overlay" style="display: none;">
        <div class="upload-modal">
            <button class="modal-close" onclick="closeModal('uploadModal')">×</button>
            
            <div class="upload-header">
                <h2>✨ 새 작품 업로드</h2>
                <div class="upload-steps">
                    <div class="step active" data-step="1">
                        <span class="step-number">1</span>
                        <span class="step-title">파일 선택</span>
                    </div>
                    <div class="step" data-step="2">
                        <span class="step-number">2</span>
                        <span class="step-title">작품 정보</span>
                    </div>
                    <div class="step" data-step="3">
                        <span class="step-number">3</span>
                        <span class="step-title">게시 설정</span>
                    </div>
                </div>
            </div>

            <div class="upload-content">
                <!-- 1단계: 파일 선택 -->
                <div id="uploadStep1" class="upload-step active">
                    <div class="file-drop-zone" onclick="document.getElementById('fileInput').click()">
                        <div class="drop-zone-content">
                            <div class="drop-icon">📁</div>
                            <h3>작품 파일을 선택하세요</h3>
                            <p>이미지, 동영상, 문서 파일을 지원합니다</p>
                            <button class="select-file-btn">파일 선택</button>
                        </div>
                        <input type="file" id="fileInput" accept="image/*,video/*,.pdf,.doc,.docx" 
                               onchange="handleFileSelect(event)" style="display: none;">
                    </div>
                    <div id="filePreview" class="file-preview"></div>
                </div>

                <!-- 2단계: 작품 정보 -->
                <div id="uploadStep2" class="upload-step">
                    <div class="form-group">
                        <label>작품 제목 *</label>
                        <input type="text" id="workTitle" placeholder="멋진 작품 제목을 입력하세요">
                    </div>
                    <div class="form-group">
                        <label>작품 설명</label>
                        <textarea id="workDescription" placeholder="작품에 대한 설명을 입력하세요" rows="4"></textarea>
                    </div>
                    <div class="form-group">
                        <label>카테고리 *</label>
                        <select id="workCategory">
                            <option value="">카테고리를 선택하세요</option>
                            <option value="illustration">🎨 일러스트</option>
                            <option value="animation">🎬 애니메이션</option>
                            <option value="novel">📚 소설</option>
                            <option value="manga">📖 만화</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>태그</label>
                        <input type="text" id="workTags" placeholder="태그를 쉼표로 구분해서 입력하세요">
                    </div>
                </div>

                <!-- 3단계: 게시 설정 -->
                <div id="uploadStep3" class="upload-step">
                    <div class="form-group">
                        <label>공개 설정</label>
                        <div class="radio-group">
                            <label class="radio-option">
                                <input type="radio" name="visibility" value="public" checked>
                                <span class="radio-label">
                                    <strong>공개</strong>
                                    <small>누구나 볼 수 있습니다</small>
                                </span>
                            </label>
                            <label class="radio-option">
                                <input type="radio" name="visibility" value="unlisted">
                                <span class="radio-label">
                                    <strong>링크만 공개</strong>
                                    <small>링크를 아는 사람만 볼 수 있습니다</small>
                                </span>
                            </label>
                            <label class="radio-option">
                                <input type="radio" name="visibility" value="private">
                                <span class="radio-label">
                                    <strong>비공개</strong>
                                    <small>나만 볼 수 있습니다</small>
                                </span>
                            </label>
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="checkbox-label">
                            <input type="checkbox" id="allowComments" checked>
                            <span>댓글 허용</span>
                        </label>
                        <label class="checkbox-label">
                            <input type="checkbox" id="allowDownload">
                            <span>다운로드 허용</span>
                        </label>
                    </div>
                </div>
            </div>

            <div class="upload-actions">
                <div class="upload-progress" id="uploadProgress" style="display: none;">
                    <div class="progress-bar">
                        <div class="progress-fill" id="progressFill"></div>
                    </div>
                    <span class="progress-text" id="progressText">0%</span>
                </div>
                
                <div class="action-buttons">
                    <button id="uploadPrevBtn" class="upload-btn secondary" onclick="previousStep()" style="display: none;">이전</button>
                    <button class="upload-btn secondary" onclick="closeModal('uploadModal')">취소</button>
                    <button id="uploadNextBtn" class="upload-btn primary" onclick="nextStep()">다음</button>
                    <button id="uploadSubmitBtn" class="upload-btn primary" onclick="submitUpload()" style="display: none;">업로드</button>
                </div>
            </div>
        </div>
    </div>

    <!-- 커뮤니티 생성 모달 -->
    <div id="createCommunityModal" class="modal-overlay" style="display: none;">
        <div class="community-modal">
            <button class="modal-close" onclick="closeModal('createCommunityModal')">×</button>
            
            <div class="modal-header">
                <h2>새 커뮤니티 만들기</h2>
                <p>같은 관심사를 가진 사람들과 함께하세요</p>
            </div>

            <div class="modal-content">
                <div class="form-group">
                    <label>커뮤니티 이미지</label>
                    <div class="image-upload-area" onclick="document.getElementById('communityImage').click()">
                        <div class="upload-placeholder">
                            <span class="upload-icon">📸</span>
                            <span>이미지 추가</span>
                        </div>
                        <input type="file" id="communityImage" accept="image/*" style="display: none;">
                    </div>
                </div>
                
                <div class="form-group">
                    <label>커뮤니티 이름 *</label>
                    <input type="text" id="communityName" placeholder="커뮤니티 이름을 입력하세요">
                </div>
                
                <div class="form-group">
                    <label>카테고리 *</label>
                    <select id="communityCategory">
                        <option value="">카테고리를 선택하세요</option>
                        <option value="animation">🎬 애니메이션</option>
                        <option value="illustration">🎨 일러스트</option>
                        <option value="novel">📚 소설</option>
                        <option value="manga">📖 만화</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label>커뮤니티 소개</label>
                    <textarea id="communityDescription" placeholder="커뮤니티에 대해 간단히 소개해주세요" rows="3"></textarea>
                </div>
                
                <div class="form-group">
                    <label>공개 설정</label>
                    <div class="radio-group">
                        <label class="radio-option">
                            <input type="radio" name="communityPrivacy" value="public" checked>
                            <span class="radio-label">
                                <strong>공개 커뮤니티</strong>
                                <small>누구나 참여할 수 있습니다</small>
                            </span>
                        </label>
                        <label class="radio-option">
                            <input type="radio" name="communityPrivacy" value="private">
                            <span class="radio-label">
                                <strong>비공개 커뮤니티</strong>
                                <small>승인 후 참여할 수 있습니다</small>
                            </span>
                        </label>
                    </div>
                </div>
            </div>

            <div class="modal-actions">
                <button class="modal-btn secondary" onclick="closeModal('createCommunityModal')">취소</button>
                <button class="modal-btn primary" onclick="createCommunity()">커뮤니티 만들기</button>
            </div>
        </div>
    </div>

    <!-- Firebase 스크립트 -->
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
        import { getAuth, createUserWithEmailAndPassword, signInWithEmailAndPassword, GoogleAuthProvider, signInWithPopup, onAuthStateChanged, signOut, updateProfile } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";
        import { getFirestore, collection, addDoc, getDocs, doc, setDoc, serverTimestamp, query, orderBy, where, onSnapshot, updateDoc, increment } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";
        import { getStorage, ref, uploadBytes, getDownloadURL } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-storage.js";

        const firebaseConfig = {
            apiKey: "AIzaSyAYrLmXnpMPd0FjGQ-3_IXBF_ZqGV-mOk8",
            authDomain: "creta-30c69.firebaseapp.com",
            projectId: "creta-30c69",
            storageBucket: "creta-30c69.firebasestorage.app",
            messagingSenderId: "126716257571",
            appId: "1:126716257571:web:33dfd5dbd1bcdb7a229896"
        };

        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        const db = getFirestore(app);
        const storage = getStorage(app);

        // 전역 객체에 할당
        window.auth = auth;
        window.db = db;
        window.storage = storage;
        window.firebaseModules = {
            createUserWithEmailAndPassword,
            signInWithEmailAndPassword,
            GoogleAuthProvider,
            signInWithPopup,
            onAuthStateChanged,
            signOut,
            updateProfile,
            collection,
            addDoc,
            getDocs,
            doc,
            setDoc,
            serverTimestamp,
            query,
            orderBy,
            where,
            onSnapshot,
            updateDoc,
            increment,
            ref,
            uploadBytes,
            getDownloadURL
        };

        // 로딩 화면 처리
        setTimeout(() => {
            document.getElementById('loadingScreen').style.display = 'none';
        }, 2000);

        // 인증 상태 감지
        onAuthStateChanged(auth, (user) => {
            if (user) {
                showMainApp(user);
            } else {
                showAuthModal();
            }
        });

        function showMainApp(user) {
            document.getElementById('authModal').style.display = 'none';
            document.getElementById('mainApp').style.display = 'block';
            
            // 사용자 정보 업데이트
            const displayName = user.displayName || user.email.split('@')[0];
            const userInitial = displayName.charAt(0).toUpperCase();
            
            document.getElementById('userInitial').textContent = userInitial;
            document.getElementById('welcomeName').textContent = displayName;
            document.getElementById('profileName').textContent = displayName;
            document.getElementById('profileHandle').textContent = `@${displayName.toLowerCase()}`;
            document.getElementById('profileAvatar').textContent = userInitial;
            document.querySelector('.logout').style.display = 'block';
            
            // 데이터 로드
            window.loadInitialData && window.loadInitialData();
        }

        function showAuthModal() {
            document.getElementById('authModal').style.display = 'flex';
            document.getElementById('mainApp').style.display = 'none';
        }

        window.showMainApp = showMainApp;
        window.showAuthModal = showAuthModal;
    </script>

    <script src="script.js"></script>
</body>
</html>

